package proyecto.vista;

import java.text.DecimalFormat;
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;
import java.util.Comparator;
import java.util.List;
import java.util.Set;
import java.util.TreeSet;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;
import proyecto.controlador.ProductoController;
import proyecto.modelo.Producto;
import proyecto.modelo.Producto;
import proyecto.vista.form_RegistraProducto;
import com.lowagie.text.Chunk;
import com.lowagie.text.Document;
import com.lowagie.text.Element;
import com.lowagie.text.Font;
import com.lowagie.text.PageSize;
import com.lowagie.text.Paragraph;
import com.lowagie.text.Phrase;
import com.lowagie.text.pdf.PdfPCell;
import com.lowagie.text.pdf.PdfPTable;
import com.lowagie.text.pdf.PdfWriter;
import java.awt.Color;
import java.io.FileOutputStream;
import java.text.SimpleDateFormat;
import java.util.Date;
import com.lowagie.text.Document;
import com.lowagie.text.DocumentException;
import com.lowagie.text.Element;
import com.lowagie.text.Font;
import com.lowagie.text.PageSize;
import com.lowagie.text.Paragraph;
import com.lowagie.text.Phrase;
import com.lowagie.text.Chunk;
import com.lowagie.text.FontFactory;
import com.lowagie.text.pdf.PdfWriter;
import com.lowagie.text.pdf.PdfPTable;
import com.lowagie.text.pdf.PdfPCell;
import java.awt.Color;
import java.awt.Component;

// Utilidades Java
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileOutputStream;
import java.io.FileWriter;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

// Swing
import javax.swing.JDialog;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.ListSelectionModel;
import javax.swing.filechooser.FileNameExtensionFilter;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.DefaultTableModel;

/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
/**
 *
 * @author User0
 */
public class form_JefeAbasGestionInventario extends javax.swing.JFrame {

    /**
     * Creates new form form_SistemaEmpleadoPanel
     */
    public form_JefeAbasGestionInventario() {
        initComponents();
        configurarTablaDetalleOrden();
        cargarTablaProductos();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jButton1 = new javax.swing.JButton();
        jTextField6 = new javax.swing.JTextField();
        jMenuItem1 = new javax.swing.JMenuItem();
        JP_Sistema = new javax.swing.JTabbedPane();
        JP_Productos = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tblProductos = new javax.swing.JTable();
        btnEliminarProducto = new javax.swing.JButton();
        btnRegistrarProducto = new javax.swing.JButton();
        lblLogin = new javax.swing.JLabel();
        btnActualizarCantidad = new javax.swing.JButton();
        jPanel1 = new javax.swing.JPanel();
        btnCerrarSesion = new javax.swing.JToggleButton();
        jPanel4 = new javax.swing.JPanel();
        lblCliente2 = new javax.swing.JLabel();
        cmbMarcaBusqueda = new javax.swing.JComboBox<>();
        btnDesc = new javax.swing.JButton();
        jPanel5 = new javax.swing.JPanel();
        lblCliente = new javax.swing.JLabel();
        btnAsc = new javax.swing.JButton();
        JP_StockCritico = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        tblStockCritico = new javax.swing.JTable();
        btnVisualizarProductoDetalle = new javax.swing.JButton();
        lblLogin2 = new javax.swing.JLabel();
        btnResumenCritico = new javax.swing.JButton();
        cmbNivelStock = new javax.swing.JComboBox<>();
        jLabel1 = new javax.swing.JLabel();
        btnCerrarSesion2 = new javax.swing.JToggleButton();
        JP_GenOrdenesCompra = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        tblDetalleOrden = new javax.swing.JTable();
        lblLogin1 = new javax.swing.JLabel();
        jPanel2 = new javax.swing.JPanel();
        btnCerrarSesion3 = new javax.swing.JToggleButton();
        cmbUbicacionOrden = new javax.swing.JComboBox<>();
        cmbModeloOrden = new javax.swing.JComboBox<>();
        cmbMarcaOrden = new javax.swing.JComboBox<>();
        txtCantidad = new javax.swing.JTextField();
        lblCantidad = new javax.swing.JLabel();
        btnGenerarOrdenCompra = new javax.swing.JToggleButton();
        cmbProveedorOrden = new javax.swing.JComboBox<>();
        jPanel3 = new javax.swing.JPanel();
        cmbMarcaBusqueda1 = new javax.swing.JComboBox<>();
        lblCliente1 = new javax.swing.JLabel();
        btnEliminar1 = new javax.swing.JButton();
        btnGenerarPDF1 = new javax.swing.JToggleButton();
        lblLogin3 = new javax.swing.JLabel();

        jButton1.setText("jButton1");

        jTextField6.setBorder(javax.swing.BorderFactory.createTitledBorder("Nombre del Proveedor"));

        jMenuItem1.setText("jMenuItem1");

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("Panel de Gestión de Inventario");
        setResizable(false);
        getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        JP_Sistema.setBackground(new java.awt.Color(255, 184, 35));

        JP_Productos.setBackground(new java.awt.Color(255, 204, 0));
        JP_Productos.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        tblProductos.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        tblProductos.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {},
                {},
                {},
                {}
            },
            new String [] {

            }
        ));
        jScrollPane1.setViewportView(tblProductos);

        JP_Productos.add(jScrollPane1, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 150, 700, 340));

        btnEliminarProducto.setBackground(new java.awt.Color(255, 69, 69));
        btnEliminarProducto.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        btnEliminarProducto.setText("Eliminar producto");
        btnEliminarProducto.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEliminarProductoActionPerformed(evt);
            }
        });
        JP_Productos.add(btnEliminarProducto, new org.netbeans.lib.awtextra.AbsoluteConstraints(540, 510, 170, 30));

        btnRegistrarProducto.setBackground(new java.awt.Color(168, 205, 137));
        btnRegistrarProducto.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        btnRegistrarProducto.setText("Ventana Registro Producto");
        btnRegistrarProducto.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnRegistrarProductoActionPerformed(evt);
            }
        });
        JP_Productos.add(btnRegistrarProducto, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 510, 250, 30));

        lblLogin.setFont(new java.awt.Font("Microsoft PhagsPa", 1, 48)); // NOI18N
        lblLogin.setForeground(new java.awt.Color(0, 48, 146));
        lblLogin.setText("GESTIÓN PRODUCTOS");
        JP_Productos.add(lblLogin, new org.netbeans.lib.awtextra.AbsoluteConstraints(110, 20, 520, 60));

        btnActualizarCantidad.setBackground(new java.awt.Color(145, 200, 228));
        btnActualizarCantidad.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        btnActualizarCantidad.setText("Actualizar Cantidad");
        btnActualizarCantidad.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnActualizarCantidadActionPerformed(evt);
            }
        });
        JP_Productos.add(btnActualizarCantidad, new org.netbeans.lib.awtextra.AbsoluteConstraints(340, 510, 190, 30));

        jPanel1.setBackground(new java.awt.Color(106, 128, 185));
        jPanel1.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        btnCerrarSesion.setBackground(new java.awt.Color(255, 0, 0));
        btnCerrarSesion.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        btnCerrarSesion.setForeground(new java.awt.Color(255, 255, 255));
        btnCerrarSesion.setText("Cerrar sesión");
        btnCerrarSesion.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCerrarSesionActionPerformed(evt);
            }
        });
        jPanel1.add(btnCerrarSesion, new org.netbeans.lib.awtextra.AbsoluteConstraints(60, 510, -1, 30));

        jPanel4.setBackground(new java.awt.Color(77, 85, 204));
        jPanel4.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(255, 255, 255)));
        jPanel4.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        lblCliente2.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        lblCliente2.setForeground(new java.awt.Color(255, 255, 255));
        lblCliente2.setText("Filtrar por :");
        jPanel4.add(lblCliente2, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 0, 100, 50));

        cmbMarcaBusqueda.setBackground(new java.awt.Color(255, 227, 187));
        cmbMarcaBusqueda.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        cmbMarcaBusqueda.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Marca", "Redmi", "Samsung", "LG", "Galaxi", "POCO", "Honor", "Nokia", "SPARK", "Meizu", "Huawei", "Movie", "Moto", "Tecno", "Vivo", "ZTE", "Itel", "Etoway", "Verde", "Mobile", "Lotn", "Snapnini", "Sky rock", "Sole", "Very Kool", "Gol", "Snap nini", "Logic", "JTEL" }));
        cmbMarcaBusqueda.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED, new java.awt.Color(255, 255, 204), new java.awt.Color(255, 255, 204), new java.awt.Color(255, 255, 204), new java.awt.Color(255, 255, 204)));
        cmbMarcaBusqueda.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmbMarcaBusquedaActionPerformed(evt);
            }
        });
        jPanel4.add(cmbMarcaBusqueda, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 50, 150, -1));

        jPanel1.add(jPanel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 150, 170, 110));

        JP_Productos.add(jPanel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(720, 0, 190, 580));

        btnDesc.setBackground(new java.awt.Color(255, 227, 187));
        btnDesc.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        btnDesc.setText("DESCENDENTE");
        btnDesc.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnDescActionPerformed(evt);
            }
        });
        JP_Productos.add(btnDesc, new org.netbeans.lib.awtextra.AbsoluteConstraints(550, 100, 150, 30));

        jPanel5.setBackground(new java.awt.Color(255, 242, 175));
        jPanel5.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        jPanel5.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        lblCliente.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        lblCliente.setForeground(new java.awt.Color(51, 51, 51));
        lblCliente.setText("Ordenar por  precio:");
        jPanel5.add(lblCliente, new org.netbeans.lib.awtextra.AbsoluteConstraints(220, 10, 160, 20));

        btnAsc.setBackground(new java.awt.Color(255, 227, 187));
        btnAsc.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        btnAsc.setText("ASCENDENTE");
        btnAsc.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAscActionPerformed(evt);
            }
        });
        jPanel5.add(btnAsc, new org.netbeans.lib.awtextra.AbsoluteConstraints(380, 10, 150, 30));

        JP_Productos.add(jPanel5, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 90, 700, 50));

        JP_Sistema.addTab("Productos", JP_Productos);

        JP_StockCritico.setBackground(new java.awt.Color(255, 204, 0));
        JP_StockCritico.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        tblStockCritico.setBackground(new java.awt.Color(255, 255, 204));
        tblStockCritico.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        tblStockCritico.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {},
                {},
                {},
                {}
            },
            new String [] {

            }
        ));
        jScrollPane2.setViewportView(tblStockCritico);

        JP_StockCritico.add(jScrollPane2, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 130, 870, 360));

        btnVisualizarProductoDetalle.setBackground(new java.awt.Color(255, 130, 130));
        btnVisualizarProductoDetalle.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        btnVisualizarProductoDetalle.setForeground(new java.awt.Color(255, 255, 255));
        btnVisualizarProductoDetalle.setText("Visualizar");
        btnVisualizarProductoDetalle.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVisualizarProductoDetalleActionPerformed(evt);
            }
        });
        JP_StockCritico.add(btnVisualizarProductoDetalle, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 510, 120, 30));

        lblLogin2.setFont(new java.awt.Font("Microsoft PhagsPa", 1, 48)); // NOI18N
        lblLogin2.setForeground(new java.awt.Color(0, 48, 146));
        lblLogin2.setText("VERIFICACIÓN DE STOCK");
        JP_StockCritico.add(lblLogin2, new org.netbeans.lib.awtextra.AbsoluteConstraints(180, 10, 600, 80));

        btnResumenCritico.setBackground(new java.awt.Color(67, 0, 255));
        btnResumenCritico.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        btnResumenCritico.setForeground(new java.awt.Color(255, 255, 255));
        btnResumenCritico.setText("Resumen");
        btnResumenCritico.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnResumenCriticoActionPerformed(evt);
            }
        });
        JP_StockCritico.add(btnResumenCritico, new org.netbeans.lib.awtextra.AbsoluteConstraints(170, 510, 100, 30));

        cmbNivelStock.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        cmbNivelStock.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Todos", "Crítico", "Moderado" }));
        cmbNivelStock.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmbNivelStockActionPerformed(evt);
            }
        });
        JP_StockCritico.add(cmbNivelStock, new org.netbeans.lib.awtextra.AbsoluteConstraints(780, 100, 110, -1));

        jLabel1.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        jLabel1.setText("Nivel de Stock: ");
        JP_StockCritico.add(jLabel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(670, 100, -1, -1));

        btnCerrarSesion2.setBackground(new java.awt.Color(255, 0, 0));
        btnCerrarSesion2.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        btnCerrarSesion2.setForeground(new java.awt.Color(255, 255, 255));
        btnCerrarSesion2.setText("Cerrar sesión");
        btnCerrarSesion2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCerrarSesion2ActionPerformed(evt);
            }
        });
        JP_StockCritico.add(btnCerrarSesion2, new org.netbeans.lib.awtextra.AbsoluteConstraints(780, 520, -1, 30));

        JP_Sistema.addTab("Verificación de Stock", JP_StockCritico);

        JP_GenOrdenesCompra.setBackground(new java.awt.Color(255, 204, 0));
        JP_GenOrdenesCompra.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        tblDetalleOrden.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {},
                {},
                {},
                {}
            },
            new String [] {

            }
        ));
        jScrollPane3.setViewportView(tblDetalleOrden);

        JP_GenOrdenesCompra.add(jScrollPane3, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 130, 610, 370));

        lblLogin1.setFont(new java.awt.Font("Microsoft PhagsPa", 1, 48)); // NOI18N
        lblLogin1.setForeground(new java.awt.Color(0, 48, 146));
        lblLogin1.setText("GENERACIÓN DE ");
        JP_GenOrdenesCompra.add(lblLogin1, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 10, 600, 60));

        jPanel2.setBackground(new java.awt.Color(61, 144, 215));
        jPanel2.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        btnCerrarSesion3.setBackground(new java.awt.Color(255, 0, 0));
        btnCerrarSesion3.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        btnCerrarSesion3.setForeground(new java.awt.Color(255, 255, 255));
        btnCerrarSesion3.setText("Cerrar sesión");
        btnCerrarSesion3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCerrarSesion3ActionPerformed(evt);
            }
        });
        jPanel2.add(btnCerrarSesion3, new org.netbeans.lib.awtextra.AbsoluteConstraints(120, 510, -1, 30));

        cmbUbicacionOrden.setBackground(new java.awt.Color(234, 250, 234));
        cmbUbicacionOrden.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        cmbUbicacionOrden.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Ubicación", "Cajamarca", "Lima", " " }));
        cmbUbicacionOrden.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmbUbicacionOrdenActionPerformed(evt);
            }
        });
        jPanel2.add(cmbUbicacionOrden, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 330, 240, 30));

        cmbModeloOrden.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        cmbModeloOrden.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Modelo", "Note 10 5G", "M51", "S7", "14 Note Pro", "K55", "Note 14", "16 5G", "16", "A32", "A50 5G", "A30 5G", "M4 Pro 5G", "200", "Note 12 Pro", "Note 14M", "A10", "Note 12S", "A25 5G", "Note 10S", "Note 10 Pro", "A12", "4.2", "30 C", "X6A", "X7B", "Note 13", "Note 13C", "C31", "14C", "M6 Note", "Y6 Prime", "A Cool", "F Cool", "P Cool", "Y6 2017", "Y6 2019", "B154 Pro", "Y7 Pro 2019", "A03", "E22i", "A09", "E15", "Spark GO1", "A03s", "K22", "Y15S", "A73", "Play 9A", "A9X", "X5 6 Plus", "A3X", "A06", "A05", "A05S", "Blade A05", "Android 6.0", "10 5G", "Mobile 2.5D", "BL 54 prime", "A55", "A35", "Q3", "3", "2", "C100", "I129a", "1Valeaa", "i29a", "F5G", " " }));
        cmbModeloOrden.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmbModeloOrdenActionPerformed(evt);
            }
        });
        jPanel2.add(cmbModeloOrden, new org.netbeans.lib.awtextra.AbsoluteConstraints(130, 290, 120, 30));

        cmbMarcaOrden.setBackground(new java.awt.Color(234, 250, 234));
        cmbMarcaOrden.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        cmbMarcaOrden.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Marca", "Samsung", "Redmi", "Huawei", "Motorola", "POCO", "Honor", "ZTE", "LG", "Nokia", "Vivo", "Tecno", "Itel", "Meizu", "Etoway", "JTEl", "SPARK", "Lotn", "Snapnini", "Sky Rock", "Sole", "Very Kool", "Logic", "Verde", "Gol", "Movie", " " }));
        jPanel2.add(cmbMarcaOrden, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 290, 100, 30));

        txtCantidad.setBackground(new java.awt.Color(234, 250, 234));
        txtCantidad.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        jPanel2.add(txtCantidad, new org.netbeans.lib.awtextra.AbsoluteConstraints(130, 370, 120, 30));

        lblCantidad.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        lblCantidad.setText("Cantidad");
        jPanel2.add(lblCantidad, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 380, 90, -1));

        btnGenerarOrdenCompra.setBackground(new java.awt.Color(234, 250, 234));
        btnGenerarOrdenCompra.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        btnGenerarOrdenCompra.setText("Generar Orden de Compra");
        btnGenerarOrdenCompra.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnGenerarOrdenCompraActionPerformed(evt);
            }
        });
        jPanel2.add(btnGenerarOrdenCompra, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 410, 240, 30));

        cmbProveedorOrden.setBackground(new java.awt.Color(234, 250, 234));
        cmbProveedorOrden.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        cmbProveedorOrden.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Proveedores", "RIVACELL S.A.C. ", " " }));
        cmbProveedorOrden.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmbProveedorOrdenActionPerformed(evt);
            }
        });
        jPanel2.add(cmbProveedorOrden, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 250, 240, 30));

        jPanel3.setBackground(new java.awt.Color(77, 85, 204));
        jPanel3.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(255, 255, 255)));
        jPanel3.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        cmbMarcaBusqueda1.setBackground(new java.awt.Color(255, 204, 255));
        cmbMarcaBusqueda1.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        cmbMarcaBusqueda1.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Marca", "Samsung", "Redmi", "Huawei", "Motorola", "POCO", "Honor", "ZTE", "LG", "Nokia", "Vivo", "Tecno", "Itel", "Meizu", "Etoway", "JTEl", "SPARK", "Lotn", "Snapnini", "Sky Rock", "Sole", "Very Kool", "Logic", "Verde", "Gol", "Movie", " " }));
        cmbMarcaBusqueda1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmbMarcaBusqueda1ActionPerformed(evt);
            }
        });
        jPanel3.add(cmbMarcaBusqueda1, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 40, 220, -1));

        lblCliente1.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        lblCliente1.setForeground(new java.awt.Color(255, 255, 255));
        lblCliente1.setText("Filtrar por :");
        jPanel3.add(lblCliente1, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 0, 100, 50));

        jPanel2.add(jPanel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 130, 240, 80));

        JP_GenOrdenesCompra.add(jPanel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(650, 0, 260, 580));

        btnEliminar1.setBackground(new java.awt.Color(255, 102, 102));
        btnEliminar1.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        btnEliminar1.setForeground(new java.awt.Color(255, 255, 255));
        btnEliminar1.setText("Eliminar");
        btnEliminar1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEliminar1ActionPerformed(evt);
            }
        });
        JP_GenOrdenesCompra.add(btnEliminar1, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 510, 100, 30));

        btnGenerarPDF1.setBackground(new java.awt.Color(198, 142, 253));
        btnGenerarPDF1.setFont(new java.awt.Font("Microsoft PhagsPa", 0, 14)); // NOI18N
        btnGenerarPDF1.setForeground(new java.awt.Color(255, 255, 255));
        btnGenerarPDF1.setText("Generar PDF");
        btnGenerarPDF1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnGenerarPDF1ActionPerformed(evt);
            }
        });
        JP_GenOrdenesCompra.add(btnGenerarPDF1, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 510, 120, 30));

        lblLogin3.setFont(new java.awt.Font("Microsoft PhagsPa", 1, 48)); // NOI18N
        lblLogin3.setForeground(new java.awt.Color(0, 48, 146));
        lblLogin3.setText("ORDENES DE COMPRA");
        JP_GenOrdenesCompra.add(lblLogin3, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 70, 600, 60));

        JP_Sistema.addTab("Generación de Ordenes de Compra", JP_GenOrdenesCompra);

        getContentPane().add(JP_Sistema, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 910, 620));

        setSize(new java.awt.Dimension(921, 625));
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void cargarTablaProductos() {
        ProductoController controller = new ProductoController();
        List<Producto> productos = controller.listarProductos();

        DefaultTableModel modeloTabla = new DefaultTableModel();
        modeloTabla.addColumn("Marca");
        modeloTabla.addColumn("Modelo");
        modeloTabla.addColumn("Precio");
        modeloTabla.addColumn("Stock");

        if (productos.isEmpty()) {
            JOptionPane.showMessageDialog(this, "No se encontraron productos registrados.", "Aviso", JOptionPane.INFORMATION_MESSAGE);
        }

        for (Producto p : productos) {
            Object[] fila = {p.getMarca(), p.getModelo(), p.getPrecio(), p.getStock()};
            modeloTabla.addRow(fila);
        }

        tblProductos.setModel(modeloTabla);
    }

    private void configurarTablaDetalleOrden() {
        DefaultTableModel modelo = new DefaultTableModel() {
            @Override
            public Class<?> getColumnClass(int columnIndex) {
                switch (columnIndex) {
                    case 0:
                        return Boolean.class; // Selección
                    case 1:
                        return String.class;  // Marca
                    case 2:
                        return String.class;  // Modelo
                    case 3:
                        return Integer.class; // Cantidad
                    case 4:
                        return Double.class;  // Precio Unitario
                    case 5:
                        return Double.class;  // Total
                    default:
                        return Object.class;
                }
            }

            @Override
            public boolean isCellEditable(int row, int column) {
                return column == 0; // Solo el checkbox editable
            }
        };

        modelo.addColumn("Seleccionar");
        modelo.addColumn("Proveedor");
        modelo.addColumn("Marca");
        modelo.addColumn("Modelo");
        modelo.addColumn("Cantidad");
        modelo.addColumn("Precio Unitario");
        modelo.addColumn("Total");

        tblDetalleOrden.setModel(modelo);
    }

    private void cargarTablaStockCritico() {
        // Configurar el modelo de la tabla con columnas
        DefaultTableModel modelo = new DefaultTableModel(
                new Object[]{"Marca", "Modelo", "Precio", "Stock", "Nivel"}, 0
        ) {
            @Override
            public boolean isCellEditable(int row, int column) {
                return false; // La tabla será solo de lectura
            }
        };

        tblStockCritico.setModel(modelo);

        // Verificar si hay productos en la lista
        if (ProductoController.listaProductos.isEmpty()) {
            JOptionPane.showMessageDialog(this, "No hay productos registrados.", "Información", JOptionPane.INFORMATION_MESSAGE);
            return;
        }

        // Llenar la tabla con los productos
        for (Producto p : ProductoController.listaProductos) {
            String nivel = (p.getStock() < 3) ? "Crítico" : "Moderado";
            modelo.addRow(new Object[]{
                p.getMarca(),
                p.getModelo(),
                String.format("%.2f", p.getPrecio()), // Precio con 2 decimales
                p.getStock(),
                nivel
            });
        }

        // Aplicar colores por fila según el nivel
        tblStockCritico.setDefaultRenderer(Object.class, new DefaultTableCellRenderer() {
            @Override
            public Component getTableCellRendererComponent(JTable table, Object value, boolean isSelected,
                    boolean hasFocus, int row, int column) {
                Component c = super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);

                // Solo aplicar colores si la tabla tiene suficientes columnas
                if (table.getColumnCount() > 4) {
                    String nivel = table.getValueAt(row, 4).toString(); // Columna 4 = "Nivel"

                    if (!isSelected) {
                        if (nivel.equalsIgnoreCase("Crítico")) {
                            c.setBackground(new Color(255, 204, 204)); // Rojo claro
                        } else {
                            c.setBackground(new Color(204, 255, 204)); // Verde claro
                        }
                    } else {
                        c.setBackground(new Color(184, 207, 229)); // Azul de selección
                    }
                }
                return c;
            }
        });

    }


    private void btnVisualizarProductoDetalleActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVisualizarProductoDetalleActionPerformed
        cargarTablaStockCritico();
    }//GEN-LAST:event_btnVisualizarProductoDetalleActionPerformed


    private void cmbProveedorOrdenActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmbProveedorOrdenActionPerformed
       
    }//GEN-LAST:event_cmbProveedorOrdenActionPerformed


    private void cmbMarcaBusquedaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmbMarcaBusquedaActionPerformed

        String marcaSeleccionada = cmbMarcaBusqueda.getSelectedItem().toString().trim();

        ProductoController controller = new ProductoController();
        List<Producto> productos = controller.listarProductos();

        // Crear modelo de tabla con columnas
        DefaultTableModel modeloTabla = new DefaultTableModel();
        modeloTabla.addColumn("Marca");
        modeloTabla.addColumn("Modelo");
        modeloTabla.addColumn("Precio");
        modeloTabla.addColumn("Stock"); // Asegúrate de tener esta columna

        // Agregar productos filtrados por marca
        for (Producto p : productos) {
            String marca = (p.getMarca() != null) ? p.getMarca().trim() : "";

            if (marcaSeleccionada.equalsIgnoreCase("Marca") || marca.equalsIgnoreCase(marcaSeleccionada)) {
                Object[] fila = {
                    p.getMarca(),
                    p.getModelo(),
                    p.getPrecio(),
                    p.getStock() // ← Este era el que faltaba
                };
                modeloTabla.addRow(fila);
            }
        }

        // Establecer el modelo corregido en la tabla
        tblProductos.setModel(modeloTabla);
    }//GEN-LAST:event_cmbMarcaBusquedaActionPerformed


    private void btnRegistrarProductoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnRegistrarProductoActionPerformed
        //abre elr egistro JDialogo form_RegistroProducot
        // Abrir el JDialog de registro
        form_RegistraProducto dialogo = new form_RegistraProducto((java.awt.Frame) javax.swing.SwingUtilities.getWindowAncestor(this), true);
        dialogo.setLocationRelativeTo(this);
        dialogo.setVisible(true);

        // Si el producto fue registrado, actualizar la tabla
        if (dialogo.isProductoRegistrado()) {
            cargarTablaProductos();
        }

    }//GEN-LAST:event_btnRegistrarProductoActionPerformed

    private void btnEliminarProductoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEliminarProductoActionPerformed
        int filaSeleccionada = tblProductos.getSelectedRow();

        if (filaSeleccionada == -1) {
            JOptionPane.showMessageDialog(this, "Por favor selecciona un producto para eliminar.", "Aviso", JOptionPane.WARNING_MESSAGE);
            return;
        }

        //  CORREGIDO: primero MARCA, luego MODELO
        String marca = tblProductos.getValueAt(filaSeleccionada, 0).toString(); // Columna 0 = Marca
        String modelo = tblProductos.getValueAt(filaSeleccionada, 1).toString(); // Columna 1 = Modelo

        int confirmacion = JOptionPane.showConfirmDialog(
                this,
                "¿Estás seguro que deseas eliminar el producto:\nMarca: " + marca + "\nModelo: " + modelo + "?",
                "Confirmar eliminación",
                JOptionPane.YES_NO_OPTION
        );

        if (confirmacion == JOptionPane.YES_OPTION) {
            ProductoController controller = new ProductoController();

            // ⚠️ CORREGIDO: primero marca, luego modelo
            boolean eliminado = controller.eliminarProducto(marca, modelo);

            if (eliminado) {
                JOptionPane.showMessageDialog(this, "Producto eliminado correctamente.");
                cmbMarcaBusquedaActionPerformed(null); // refresca tabla si está filtrada
            } else {
                JOptionPane.showMessageDialog(this, "No se pudo eliminar el producto.", "Error", JOptionPane.ERROR_MESSAGE);
            }

            cargarTablaProductos(); // refresca la tabla completa
        }
    }//GEN-LAST:event_btnEliminarProductoActionPerformed

    private void btnCerrarSesionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCerrarSesionActionPerformed
        int opcion = JOptionPane.showConfirmDialog(
                this,
                "¿Estás seguro de que deseas cerrar sesión?",
                "Confirmar cierre de sesión",
                JOptionPane.YES_NO_OPTION
        );

        if (opcion == JOptionPane.YES_OPTION) {
            // Abre el formulario de login
            form_login login = new form_login();
            login.setLocationRelativeTo(null);
            login.setVisible(true);

            // Cierra la ventana actual
            this.dispose();
        }
    }//GEN-LAST:event_btnCerrarSesionActionPerformed

    private void mostrarProductosEnTabla(List<Producto> productos) {
        DefaultTableModel modeloTabla = new DefaultTableModel();
        modeloTabla.addColumn("Marca");
        modeloTabla.addColumn("Modelo");
        modeloTabla.addColumn("Precio");
        modeloTabla.addColumn("Stock");

        for (Producto p : productos) {
            Object[] fila = {p.getMarca(), p.getModelo(), p.getPrecio(), p.getStock()};
            modeloTabla.addRow(fila);
        }

        tblProductos.setModel(modeloTabla);
    }

    private void btnAscActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAscActionPerformed
        String marcaSeleccionada = cmbMarcaBusqueda.getSelectedItem().toString().trim();

        ProductoController controller = new ProductoController();
        List<Producto> productos = controller.listarProductos();

        if (!marcaSeleccionada.equalsIgnoreCase("Marca")) {
            productos.removeIf(p -> !p.getMarca().equalsIgnoreCase(marcaSeleccionada));
        }

        productos.sort(Comparator.comparingDouble(Producto::getPrecio));

        mostrarProductosEnTabla(productos);
    }//GEN-LAST:event_btnAscActionPerformed

    private void btnDescActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnDescActionPerformed
        String marcaSeleccionada = cmbMarcaBusqueda.getSelectedItem().toString().trim();

        ProductoController controller = new ProductoController();
        List<Producto> productos = controller.listarProductos();

        if (!marcaSeleccionada.equalsIgnoreCase("Marca")) {
            productos.removeIf(p -> !p.getMarca().equalsIgnoreCase(marcaSeleccionada));
        }

        productos.sort(Comparator.comparingDouble(Producto::getPrecio).reversed());

        mostrarProductosEnTabla(productos);
    }//GEN-LAST:event_btnDescActionPerformed

    private void cmbMarcaBusqueda1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmbMarcaBusqueda1ActionPerformed
       
    }//GEN-LAST:event_cmbMarcaBusqueda1ActionPerformed

    private void cmbModeloOrdenActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmbModeloOrdenActionPerformed
       
    }//GEN-LAST:event_cmbModeloOrdenActionPerformed

    public void generarPDFOrdenCompra() {
        JFileChooser fileChooser = new JFileChooser();
        DecimalFormat formatoDecimal = new DecimalFormat("#.00");
        fileChooser.setDialogTitle("Guardar PDF de Orden de Compra");

        int userSelection = fileChooser.showSaveDialog(this);

        if (userSelection == JFileChooser.APPROVE_OPTION) {
            File archivoPDF = fileChooser.getSelectedFile();
            if (!archivoPDF.getAbsolutePath().endsWith(".pdf")) {
                archivoPDF = new File(archivoPDF.getAbsolutePath() + ".pdf");
            }

            try {
                Document documento = new Document(PageSize.A4.rotate());
                PdfWriter.getInstance(documento, new FileOutputStream(archivoPDF));
                documento.open();

                // Encabezado
                Font tituloFont = FontFactory.getFont(FontFactory.HELVETICA_BOLD, 18, Font.BOLD, Color.RED);
                Paragraph titulo = new Paragraph("ORDEN DE COMPRA - MULTITEC D & J EMPRESA", tituloFont);
                titulo.setAlignment(Element.ALIGN_CENTER);
                documento.add(titulo);

                documento.add(new Paragraph(" "));
                documento.add(new Paragraph("RUC: 20547854123"));
                documento.add(new Paragraph("Generado por: Jefe de Abastecimiento"));
                documento.add(new Paragraph("Fecha y hora: " + new SimpleDateFormat("dd/MM/yyyy HH:mm:ss").format(new Date())));
                documento.add(new Paragraph(" "));

                // Crear tabla
                PdfPTable tabla = new PdfPTable(6); // columnas
                tabla.setWidthPercentage(100);

                String[] encabezados = {"Proveedor", "Marca", "Modelo", "Cantidad", "Precio Unitario", "Total"};
                for (String enc : encabezados) {
                    PdfPCell cell = new PdfPCell(new Phrase(enc));
                    cell.setBackgroundColor(Color.LIGHT_GRAY);
                    tabla.addCell(cell);
                }

                DefaultTableModel modeloTabla = (DefaultTableModel) tblDetalleOrden.getModel();
                int totalFilas = modeloTabla.getRowCount();

                for (int i = 0; i < totalFilas; i++) {
                    Boolean seleccionado = Boolean.valueOf(modeloTabla.getValueAt(i, 0).toString());
                    if (seleccionado) {
                        tabla.addCell(modeloTabla.getValueAt(i, 1).toString()); // Proveedor
                        tabla.addCell(modeloTabla.getValueAt(i, 2).toString()); // Marca
                        tabla.addCell(modeloTabla.getValueAt(i, 3).toString()); // Modelo
                        tabla.addCell(modeloTabla.getValueAt(i, 4).toString()); // Cantidad
                        tabla.addCell(modeloTabla.getValueAt(i, 5).toString()); // Precio Unitario
                        tabla.addCell(modeloTabla.getValueAt(i, 6).toString()); // Total

                        // Formatear precio unitario y total con 2 decimales
                        double precioUnitario = Double.parseDouble(modeloTabla.getValueAt(i, 5).toString());
                        double total = Double.parseDouble(modeloTabla.getValueAt(i, 6).toString());

                        tabla.addCell("S/ " + formatoDecimal.format(precioUnitario));
                        tabla.addCell("S/ " + formatoDecimal.format(total));

                    }
                }

                documento.add(tabla);
                documento.close();

                JOptionPane.showMessageDialog(this, "PDF generado correctamente: " + archivoPDF.getAbsolutePath());

            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, "Error al generar el PDF: " + e.getMessage());
                e.printStackTrace();
            }
        }
    }


    private void btnGenerarOrdenCompraActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnGenerarOrdenCompraActionPerformed
        String proveedor = cmbProveedorOrden.getSelectedItem().toString();
        String marca = cmbMarcaOrden.getSelectedItem().toString();
        String modelo = cmbModeloOrden.getSelectedItem().toString();
        String ubicacion = cmbUbicacionOrden.getSelectedItem().toString();
        String cantidadStr = txtCantidad.getText().trim();

        // Validar proveedor vs ubicación
        if (proveedor.equalsIgnoreCase("RIVACELL S.A.C.") && !ubicacion.equalsIgnoreCase("Cajamarca")) {
            JOptionPane.showMessageDialog(this, "El proveedor RIVACELL S.A.C. solo está disponible en Cajamarca.", "Proveedor no disponible", JOptionPane.WARNING_MESSAGE);
            return;
        }

        // Validar campos vacíos
        if (marca.isEmpty() || modelo.isEmpty() || cantidadStr.isEmpty()) {
            JOptionPane.showMessageDialog(this, "Por favor, complete todos los campos.", "Campos incompletos", JOptionPane.WARNING_MESSAGE);
            return;
        }

        int cantidad;
        try {
            cantidad = Integer.parseInt(cantidadStr);
            if (cantidad <= 0) {
                throw new NumberFormatException();
            }
        } catch (NumberFormatException e) {
            JOptionPane.showMessageDialog(this, "Ingrese una cantidad válida mayor a 0.", "Cantidad inválida", JOptionPane.ERROR_MESSAGE);
            return;
        }

        // Obtener precio del producto desde la lista de productos
        double precioUnitario = 0.0;
        for (Producto p : new ProductoController().listarProductos()) {
            if (p.getModelo().equalsIgnoreCase(modelo) && p.getMarca().equalsIgnoreCase(marca)) {
                precioUnitario = p.getPrecio();
                break;
            }
        }

        if (precioUnitario == 0.0) {
            JOptionPane.showMessageDialog(this, "No se encontró el producto seleccionado en la base de datos.", "Producto no disponible", JOptionPane.ERROR_MESSAGE);
            return;
        }

        double precioTotal = cantidad * precioUnitario;

        // Agregar fila a la tabla
        DefaultTableModel modeloTabla = (DefaultTableModel) tblDetalleOrden.getModel();
        modeloTabla.addRow(new Object[]{
            false, // Checkbox
            proveedor,
            marca,
            modelo,
            cantidad,
            precioUnitario,
            precioTotal
        });

        JOptionPane.showMessageDialog(this, "Orden generada correctamente.");
    }//GEN-LAST:event_btnGenerarOrdenCompraActionPerformed

    private void btnGenerarPDF1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnGenerarPDF1ActionPerformed
        generarPDFOrdenCompra();
    }//GEN-LAST:event_btnGenerarPDF1ActionPerformed

    private void btnEliminar1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEliminar1ActionPerformed
        DefaultTableModel modeloTabla = (DefaultTableModel) tblDetalleOrden.getModel();
        boolean haySeleccion = false;

        // Verificar si hay al menos una fila seleccionada
        for (int i = 0; i < modeloTabla.getRowCount(); i++) {
            Boolean seleccionado = Boolean.valueOf(modeloTabla.getValueAt(i, 0).toString());
            if (seleccionado != null && seleccionado) {
                haySeleccion = true;
                break;
            }
        }

        if (!haySeleccion) {
            JOptionPane.showMessageDialog(this, "No ha seleccionado ninguna fila para eliminar.", "Aviso", JOptionPane.WARNING_MESSAGE);
            return;
        }

        int respuesta = JOptionPane.showConfirmDialog(this,
                "¿Está seguro de que desea eliminar las filas seleccionadas?",
                "Confirmar eliminación",
                JOptionPane.YES_NO_OPTION,
                JOptionPane.QUESTION_MESSAGE);

        if (respuesta == JOptionPane.YES_OPTION) {
            // Eliminar de abajo hacia arriba
            for (int i = modeloTabla.getRowCount() - 1; i >= 0; i--) {
                Boolean seleccionado = Boolean.valueOf(modeloTabla.getValueAt(i, 0).toString());
                if (seleccionado != null && seleccionado) {
                    modeloTabla.removeRow(i);
                }
            }
            JOptionPane.showMessageDialog(this, "Filas eliminadas correctamente.");
        }
    }//GEN-LAST:event_btnEliminar1ActionPerformed

    private void cmbUbicacionOrdenActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmbUbicacionOrdenActionPerformed
       
    }//GEN-LAST:event_cmbUbicacionOrdenActionPerformed

    private void btnActualizarCantidadActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnActualizarCantidadActionPerformed
        int filaSeleccionada = tblProductos.getSelectedRow();

        if (filaSeleccionada == -1) {
            JOptionPane.showMessageDialog(this, "Por favor selecciona un producto para actualizar.", "Aviso", JOptionPane.WARNING_MESSAGE);
            return;
        }

        String marca = tblProductos.getValueAt(filaSeleccionada, 0).toString();
        String modelo = tblProductos.getValueAt(filaSeleccionada, 1).toString();
        String stockActual = tblProductos.getValueAt(filaSeleccionada, 3).toString();

        String nuevoStockStr = JOptionPane.showInputDialog(this,
                "Producto seleccionado:\nMarca: " + marca + "\nModelo: " + modelo
                + "\nStock actual: " + stockActual + "\n\nIngrese el nuevo stock:");

        if (nuevoStockStr != null && !nuevoStockStr.trim().isEmpty()) {
            try {
                int nuevoStock = Integer.parseInt(nuevoStockStr.trim());

                if (nuevoStock < 0) {
                    JOptionPane.showMessageDialog(this, "El stock no puede ser negativo.", "Error", JOptionPane.ERROR_MESSAGE);
                    return;
                }

                int confirmacion = JOptionPane.showConfirmDialog(this,
                        "¿Deseas actualizar el stock de:\nMarca: " + marca + "\nModelo: " + modelo
                        + "\na " + nuevoStock + " unidades?",
                        "Confirmar actualización", JOptionPane.YES_NO_OPTION);

                if (confirmacion == JOptionPane.YES_OPTION) {
                    ProductoController controller = new ProductoController();
                    boolean actualizado = controller.actualizarStock(marca, modelo, nuevoStock);

                    if (actualizado) {
                        JOptionPane.showMessageDialog(this, "Stock actualizado correctamente.");
                        cargarTablaProductos(); // Refresca la tabla
                    } else {
                        JOptionPane.showMessageDialog(this, "No se pudo actualizar el stock.", "Error", JOptionPane.ERROR_MESSAGE);
                    }
                }

            } catch (NumberFormatException e) {
                JOptionPane.showMessageDialog(this, "Ingrese un número válido.", "Error", JOptionPane.ERROR_MESSAGE);
            }
        }
    }//GEN-LAST:event_btnActualizarCantidadActionPerformed


    private void cmbNivelStockActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmbNivelStockActionPerformed
        DefaultTableModel modelo = new DefaultTableModel();
        modelo.addColumn("Marca");
        modelo.addColumn("Modelo");
        modelo.addColumn("Precio");
        modelo.addColumn("Stock");
        modelo.addColumn("Nivel");

        String nivelSeleccionado = cmbNivelStock.getSelectedItem().toString();

        for (Producto p : ProductoController.listaProductos) {
            int stock = p.getStock();
            String nivel = (stock < 3) ? "Crítico" : "Moderado";

            boolean coincideNivel = nivelSeleccionado.equals("Todos") || nivel.equalsIgnoreCase(nivelSeleccionado);

            if (coincideNivel) {
                modelo.addRow(new Object[]{
                    p.getMarca(),
                    p.getModelo(),
                    String.format("%.2f", p.getPrecio()),
                    p.getStock(),
                    nivel
                });
            }
        }

        tblStockCritico.setModel(modelo);

        // Renderizado con colores
        tblStockCritico.setDefaultRenderer(Object.class, new DefaultTableCellRenderer() {
            @Override
            public Component getTableCellRendererComponent(JTable table, Object value,
                    boolean isSelected, boolean hasFocus, int row, int column) {

                Component c = super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);

                String nivel = table.getValueAt(row, 4).toString();
                if (!isSelected) {
                    if (nivel.equalsIgnoreCase("Crítico")) {
                        c.setBackground(new Color(255, 204, 204)); // Rojo claro
                    } else {
                        c.setBackground(new Color(204, 255, 204)); // Verde claro
                    }
                } else {
                    c.setBackground(new Color(184, 207, 229)); // Azul al seleccionar
                }

                return c;
            }
        });

        if (modelo.getRowCount() == 0) {
            JOptionPane.showMessageDialog(this, "No hay productos que coincidan con los filtros seleccionados.", "Información", JOptionPane.INFORMATION_MESSAGE);
        }
    }//GEN-LAST:event_cmbNivelStockActionPerformed

    private void ResumenCritico() {
        int totalCriticos = 0;
        int totalUrgentes = 0;
        List<String> productosUrgentes = new ArrayList<>();

        for (Producto p : ProductoController.listaProductos) {
            if (p.getStock() < 3) {
                totalCriticos++;
                if (p.getStock() == 0) {
                    totalUrgentes++;
                    productosUrgentes.add(p.getMarca() + " - " + p.getModelo());
                }
            }
        }

        StringBuilder mensaje = new StringBuilder();
        mensaje.append("🔴 Total de productos con stock crítico (< 3): ").append(totalCriticos).append("\n");

        if (totalUrgentes == totalCriticos && totalCriticos > 0) {
            mensaje.append("🚨 Todos los productos críticos están en stock 0. ¡Reabastecimiento urgente requerido!\n");
        } else if (productosUrgentes.isEmpty()) {
            mensaje.append("✅ No hay productos con stock 0.");
        } else {
            mensaje.append("🚨 Productos con stock = 0 (requieren atención urgente):\n");
            for (String producto : productosUrgentes) {
                mensaje.append("• ").append(producto).append("\n");
            }
        }

        if (totalCriticos == 0) {
            mensaje.setLength(0);
            mensaje.append("✅ Actualmente no hay productos con stock crítico.");
        }

        JOptionPane.showMessageDialog(this, mensaje.toString(), "Resumen de Stock Crítico", JOptionPane.INFORMATION_MESSAGE);
    }

    private void btnResumenCriticoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnResumenCriticoActionPerformed
        ResumenCritico();
    }//GEN-LAST:event_btnResumenCriticoActionPerformed

    private void btnCerrarSesion2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCerrarSesion2ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnCerrarSesion2ActionPerformed

    private void btnCerrarSesion3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCerrarSesion3ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnCerrarSesion3ActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(form_JefeAbasGestionInventario.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(form_JefeAbasGestionInventario.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(form_JefeAbasGestionInventario.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(form_JefeAbasGestionInventario.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new form_JefeAbasGestionInventario().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel JP_GenOrdenesCompra;
    private javax.swing.JPanel JP_Productos;
    private javax.swing.JTabbedPane JP_Sistema;
    private javax.swing.JPanel JP_StockCritico;
    private javax.swing.JButton btnActualizarCantidad;
    private javax.swing.JButton btnAsc;
    private javax.swing.JToggleButton btnCerrarSesion;
    private javax.swing.JToggleButton btnCerrarSesion2;
    private javax.swing.JToggleButton btnCerrarSesion3;
    private javax.swing.JButton btnDesc;
    private javax.swing.JButton btnEliminar1;
    private javax.swing.JButton btnEliminarProducto;
    private javax.swing.JToggleButton btnGenerarOrdenCompra;
    private javax.swing.JToggleButton btnGenerarPDF1;
    private javax.swing.JButton btnRegistrarProducto;
    private javax.swing.JButton btnResumenCritico;
    private javax.swing.JButton btnVisualizarProductoDetalle;
    private javax.swing.JComboBox<String> cmbMarcaBusqueda;
    private javax.swing.JComboBox<String> cmbMarcaBusqueda1;
    private javax.swing.JComboBox<String> cmbMarcaOrden;
    private javax.swing.JComboBox<String> cmbModeloOrden;
    private javax.swing.JComboBox<String> cmbNivelStock;
    private javax.swing.JComboBox<String> cmbProveedorOrden;
    private javax.swing.JComboBox<String> cmbUbicacionOrden;
    private javax.swing.JButton jButton1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JMenuItem jMenuItem1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JTextField jTextField6;
    private javax.swing.JLabel lblCantidad;
    private javax.swing.JLabel lblCliente;
    private javax.swing.JLabel lblCliente1;
    private javax.swing.JLabel lblCliente2;
    private javax.swing.JLabel lblLogin;
    private javax.swing.JLabel lblLogin1;
    private javax.swing.JLabel lblLogin2;
    private javax.swing.JLabel lblLogin3;
    private javax.swing.JTable tblDetalleOrden;
    private javax.swing.JTable tblProductos;
    private javax.swing.JTable tblStockCritico;
    private javax.swing.JTextField txtCantidad;
    // End of variables declaration//GEN-END:variables
}
